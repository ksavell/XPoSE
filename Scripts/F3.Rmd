---
title: "F3"
author: "Kareem"
date: "2023-03-15"
output: html_document
---

#Load Packages
```{r}
library(Seurat)
library(ggplot2)
library(dplyr)
library(clustree)
library(tidyverse)
```
#Load Objects
```{r}
setwd("/Users/woodskad/Desktop/Analysis/F3/")
load("/Users/woodskad/Desktop/Analysis/S1/Robject/gaba_subset_forthpipe_03142023.RData")
load("/Users/woodskad/Desktop/Analysis/S1/Robject/glut_subset_forthpipe_11102022.RData")
```
#GLUT

#Make Glut Table 
```{r}
glut.subset2$cluster_group <- paste(glut.subset2$seurat_clusters, 
                                    glut.subset2$group, 
                                    sep = "_")
df.glut1 <- data.frame(table(glut.subset2$cluster_group))
df.glut2 <- data.frame(table(glut.subset2$group))
```
#KS workspace
```{r}
df.glut1$group.freq <- insert_value(df.glut1,df.glut2, df.glut2$group.freq)

insert_value <- function(table1, table2, col_name) {
  # Identify rows in table1 that contain part of the name in table2
  match_rows <- grepl(paste0(df.glut2$Var1, collapse = "|"), df.glut1$Var1)
  
  # Insert the value from table2 into table1
  df.glut1[match_rows, col_name] <- df.glut2$Freq
  
  # Return the updated table1
  return(df.glut1)
}
```

#Subset out groups 
```{r}
glut.homecage <-subset(df.glut1, Var1 %in% c("0_homecage", "1_homecage","2_homecage", "3_homecage", "4_homecage", "5_homecage"))
glut.negative <-subset(df.glut1, Var1 %in% c("0_negative", "1_negative","2_negative", "3_negative", "4_negative", "5_negative"))
glut.positive <-subset(df.glut1, Var1 %in% c("0_positive", "1_positive","2_positive", "3_positive", "4_positive", "5_positive"))
```

#Divide subsets by total to get fractions
```{r}
df.glut3 <- data.frame(clusters=0:5,
                    homecage = c(glut.homecage/df.glut2[1,2]),
                      negative = c(glut.negative/df.glut2[2,2]),
                      positive = c(glut.positive/df.glut2[3,2]))

```


#Make Dataframe for Glut
-KS: Can you make this dataframe from the tables generated above? 
```{r}
Cluster <- c(0, 1, 2, 3, 4, 5)
Homecage <- c(2957/10550, 2733/10550, 2806/10550, 1306/10550, 463/10550, 285/10550)
Negative <- c(1286/4530, 1251/4530, 1114/4530, 605/4530, 178/4530, 96/4530)
Postive <- c(744/1854, 516/1854, 332/1854, 231/1854, 26/1854, 5/1854)
df <- data.frame(Cluster, Homecage, Negative, Postive)
print(df)
```

#GABA
#Make Gaba Table 
```{r}
gaba.subset2$cluster_group <- paste(gaba.subset2$seurat_clusters, gaba.subset2$group, sep = "_")
df.gaba1 <- data.frame(table(gaba.subset2$cluster_group))
df.gaba2 <- data.frame(table(gaba.subset2$group))

df.gaba1[nrow(df.gaba1) + 1,] <- "N/A"


```

#Subset out groups 
```{r}
gaba.homecage <-subset(df.gaba1, Var1 %in% c("0_homecage", "1_homecage","2_homecage", "3_homecage", "4_homecage", "5_homecage", "6_homecage"))
gaba.negative <-subset(df.gaba1, Var1 %in% c("0_negative", "1_negative","2_negative", "3_negative", "4_negative", "5_negative", "6_negative"))
gaba.positive <-subset(df.gaba1, Var1 %in% c("0_positive", "1_positive","2_positive", "3_positive", "4_positive", "5_positive"))
```

#Divide subsets by total to get fractions
```{r}
df.gaba3 <-data.frame(clusters=0:6,
                      homecage = c(gaba.homecage/df.gaba2[1,2]),
                         neagative = c(gaba.negative/df.gaba2[2,2]),
                         positive = c(gaba.positive/df.gaba2[3,2]))

```


#Make Dataframe for Gaba
-KS: Same here
```{r}
Cluster <- c(0, 1, 2, 3, 4, 5,6)
Homecage <- c(682/1904, 358/1904, 401/1904, 233/1904, 76/1904, 112/1904, 42/1904 )
Negative <- c(278/1036 , 141/1036 , 328/1036 , 85/1036 , 137/1036 , 52/1036, 15/1036)
Postive <- c(297/779 , 398/779 , 21/779 , 11/779 , 51/779 , 1/779, 0/779)
df.gaba <- data.frame(Cluster, Homecage, Negative, Postive)
print(df.gaba)
```
